(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{394:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"mongodb的几种启动方式"}},[t._v("mongodb的几种启动方式")]),t._v(" "),a("p",[t._v("启动Mongodb服务有两种方式，前台启动或者Daemon方式启动，前者启动会需要保持当前Session不能被关闭，后者可以作为系统的fork进程执行，下文中的path是mongodb部署的实际地址。")]),t._v(" "),a("h2",{attrs:{id:"_1-最简单的启动方式，前台启动，仅指定数据目录，并且使用默认的27107端口，cli下可以直接使用-mongo连上本机的mongodb，一般只用于临时的开发测试。"}},[t._v("1. 最简单的启动方式，前台启动，仅指定数据目录，并且使用默认的27107端口，cli下可以直接使用./mongo连上本机的mongodb，一般只用于临时的开发测试。")]),t._v(" "),a("p",[a("code",[t._v("1./mongod --dbpath=/path/mongodb")])]),t._v(" "),a("h2",{attrs:{id:"_2-启动绑定固定的ip地址、端口，这就mongo在连接mongod的时候就需要指定ip和端口了。"}},[t._v("2. 启动绑定固定的IP地址、端口，这就mongo在连接mongod的时候就需要指定IP和端口了。")]),t._v(" "),a("p",[a("code",[t._v("1./mongo 10.10.10.10:12345")])]),t._v(" "),a("h2",{attrs:{id:"_3-daemon后台运行，简单的是命令后面加“-”。"}},[t._v("3. daemon后台运行，简单的是命令后面加“&”。")]),t._v(" "),a("p",[a("code",[t._v("1./mongod --dbpath=/path/mongodb --bind_ip=10.10.10.10 --port=12345 &")]),t._v("\n或者使用mongod自带的--fork参数，此时必须指定log的路径。\n"),a("code",[t._v("1./mongod --dbpath=/path/mongodb --fork=true logpath=/path/mongod.log")])]),t._v(" "),a("h2",{attrs:{id:"_4-（推荐）以配置文件形式保存配置。"}},[t._v("4. （推荐）以配置文件形式保存配置。")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("     port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12345")]),t._v("  \n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("     bind_ip"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.10")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".10")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".10")]),t._v("  \n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("     logpath"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log  \n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("     pidfilepath"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pid  \n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("     logappend"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("  \n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("     fork"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("  \n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("p",[t._v("然后启动mongod时引入配置文件："),a("code",[t._v("./mongod -f /path/mongod.conf")])]),t._v(" "),a("p",[t._v("下面是mongod启动的常用参数详细说明：\n| 参数 | 说明 | 取值示例 |\n|  ----  | ----  |\n| dbpath | mongodb数据文件存储路径 | /data/mongodb |\n| logpath | mongod的日志路径 | /var/log/mongodb/mongodb.log |\n| logappend | 日志使用追加代替覆盖 | true |\n| bind_ip | 绑定的IP | 10.10.10.10 |\n| port | 绑定的端口 | 27107 |\n| journal | write操作首先写入“日记”，是一个数据安全的设置，具体参考官方文档。 | true |")]),t._v(" "),a("h2",{attrs:{id:"_5-mongodb开机启动"}},[t._v("5 Mongodb开机启动")]),t._v(" "),a("p",[t._v("在"),a("code",[t._v("/etc/rc.local")]),t._v("文件末尾添加下面的代码")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("#add mongodb service\nrm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rf "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongodb_data"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* && /usr/local/mongodb/bin/mongod --dbpath=/data/mongdb_data/ --logpath=/data/mongdb_log/mongodb.log --logappend &\n")])])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("##关闭mongodb")]),t._v(" "),a("p",[t._v("如果没有使用--fork，直接可以前台退出终端关闭。\n通过这种方式，Mongodb将会自己做清理退出，把没有写好的数据写完成，并最终关闭数据文件。\n要注意的是这个过程会持续到所有操作都完成。\n如果使用--fork在后台运行mongdb服务，那么就要通过向服务器发送shutdownServer()消息来关闭。")]),t._v(" "),a("h2",{attrs:{id:"_1、普通命令："}},[t._v("1、普通命令：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongod\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" use admin\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("shutdownServer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("要注意的是，这个命令只允许在本地，或是一个经过认证的客户端")]),t._v(" "),a("h2",{attrs:{id:"_2、如果这是一个主从式的复制集群，在1-9-1版本后将按下面的步骤来关闭"}},[t._v("2、如果这是一个主从式的复制集群，在1.9.1版本后将按下面的步骤来关闭")]),t._v(" "),a("p",[t._v("检查从Mongodb的数据更新时间\n如果所有的从Mongodb和主的时间差都超过10，这个时候不会关闭mongodb\n（在这种情况下面，我们可以通过配置timeoutSecs的方式来让从Mongodb完成数据的更新）\n如果其中有一个从Mongodb与主服务时间差在10秒内，那么主服务器将会关闭，并且等待从Mongodb更新完成并关闭。")]),t._v(" "),a("h2",{attrs:{id:"_3、如果没有up-to-date-从mongodb且你想强制关闭服务，可以通过添加force-true-命令如下："}},[t._v("3、如果没有up-to-date 从Mongodb且你想强制关闭服务，可以通过添加force:true;命令如下：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("adminCommand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("shutdown "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" force "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//or")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("shutdownServer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("force "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("h2",{attrs:{id:"_4、指定特定超时时间的关闭服务器，命令同上，另外加上一个timeoutsec-参数"}},[t._v("4、指定特定超时时间的关闭服务器，命令同上，另外加上一个timeoutsec:参数")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("adminCommand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("shutdown "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" force "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" timeoutsec "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//or")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("shutdownServer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("force "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" timeoutsec "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);